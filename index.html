<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Actividades - Base de Datos II</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #000;
      color: white;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #111;
      padding: 20px;
      text-align: center;
      font-size: 1.5em;
      border-bottom: 2px solid #00bfff;
    }
    .container {
      padding: 20px;
    }
    .week {
      background-color: #222;
      margin-bottom: 15px;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    h2 {
      margin-top: 0;
      color: #00bfff;
    }
    button {
      background-color: #00bfff;
      border: none;
      padding: 8px 14px;
      margin-top: 8px;
      color: #000;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0099cc;
    }
    iframe {
      width: 100%;
      height: 500px;
      border: none;
      margin-top: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>Universidad Peruana Los Andes</h1>
    <p>Base de Datos II - Actividades Semanales</p>
    <p>Alumno: <strong>Kevin Alfredo Macha Bruno</strong></p>
  </header>

  <div class="container" id="weeksContainer"></div>

  <script>
    // ðŸŸ¦ Nombre de usuario y repositorio
    const username = "KEVIN43287";
    const repo = "Actividades";
    const branch = "main";

    // ðŸŸ¦ Semanas a mostrar
    const totalSemanas = 16;

    const container = document.getElementById("weeksContainer");

    for (let i = 1; i <= totalSemanas; i++) {
      const weekDiv = document.createElement("div");
      weekDiv.classList.add("week");
      weekDiv.innerHTML = `
        <h2>Semana ${i}</h2>
        <div id="archivos-semana-${i}">Cargando archivos...</div>
        <button onclick="abrirRepositorio(${i})">Ir al repositorio</button>
      `;
      container.appendChild(weekDiv);

      cargarArchivos(i);
    }

    // ðŸŸ¦ Cargar lista de archivos desde GitHub API
    async function cargarArchivos(numSemana) {
      const url = `https://api.github.com/repos/${username}/${repo}/contents/Semana%20${numSemana}?ref=${branch}`;
      const contenedor = document.getElementById(`archivos-semana-${numSemana}`);

      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error("No se pudo cargar");
        const data = await res.json();

        // Filtrar archivos que no sean .gitkeep
        const archivosValidos = data.filter(item => item.name !== ".gitkeep");

        if (archivosValidos.length === 0) {
          contenedor.innerHTML = "<p>No hay archivos disponibles.</p>";
          return;
        }

        // Mostrar archivos
        contenedor.innerHTML = archivosValidos.map(archivo => `
          <div>
            <p>${archivo.name}</p>
            <button onclick="mostrarArchivo('${archivo.download_url}', 'visor-${numSemana}')">Ver archivo</button>
            <iframe id="visor-${numSemana}" src=""></iframe>
          </div>
        `).join("");
      } catch (err) {
        contenedor.innerHTML = "<p>Error al cargar los archivos.</p>";
      }
    }

    // ðŸŸ¦ Mostrar archivo dentro de la pÃ¡gina
    function mostrarArchivo(url, iframeId) {
      const iframe = document.getElementById(iframeId);
      iframe.src = url;
      iframe.style.display = "block";
    }

    // ðŸŸ¦ Abrir repositorio de la semana
    function abrirRepositorio(numSemana) {
      const repoURL = `https://github.com/${username}/${repo}/tree/${branch}/Semana%20${numSemana}`;
      window.open(repoURL, "_blank");
    }
  </script>
</body>
</html>
